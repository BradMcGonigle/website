<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Save Link Bookmarklet Setup</title>
    <style>
      :root {
        --bg: #0a0a0a;
        --fg: #fafafa;
        --muted: #a1a1aa;
        --border: #27272a;
        --primary: #3b82f6;
        --success: #22c55e;
        --card-bg: #18181b;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: var(--bg);
        color: var(--fg);
        line-height: 1.6;
        padding: 2rem;
        max-width: 800px;
        margin: 0 auto;
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }

      .subtitle {
        color: var(--muted);
        margin-bottom: 2rem;
      }

      section {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      h2 {
        font-size: 1.25rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      h2 .badge {
        font-size: 0.75rem;
        background: var(--primary);
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-weight: 500;
      }

      p {
        color: var(--muted);
        margin-bottom: 1rem;
      }

      ol,
      ul {
        color: var(--muted);
        padding-left: 1.5rem;
        margin-bottom: 1rem;
      }

      li {
        margin-bottom: 0.5rem;
      }

      code {
        background: var(--bg);
        padding: 0.125rem 0.375rem;
        border-radius: 4px;
        font-size: 0.875rem;
        font-family: "SF Mono", Monaco, monospace;
      }

      pre {
        background: var(--bg);
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        margin-bottom: 1rem;
      }

      pre code {
        padding: 0;
        background: none;
      }

      .bookmarklet-link {
        display: inline-block;
        background: var(--primary);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        margin: 1rem 0;
        cursor: grab;
      }

      .bookmarklet-link:hover {
        opacity: 0.9;
      }

      .config-section {
        margin-top: 1rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
      }

      input {
        width: 100%;
        padding: 0.75rem;
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        color: var(--fg);
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      input:focus {
        outline: none;
        border-color: var(--primary);
      }

      button {
        background: var(--primary);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
      }

      button:hover {
        opacity: 0.9;
      }

      .warning {
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid rgba(245, 158, 11, 0.3);
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
      }

      .warning strong {
        color: #f59e0b;
      }
    </style>
  </head>
  <body>
    <h1>Save Link Bookmarklet</h1>
    <p class="subtitle">
      Quickly save interesting links to your website from any browser.
    </p>

    <section>
      <h2>Configuration</h2>
      <p>
        Enter your API URL and API key below, then drag the bookmarklet to your
        bookmarks bar.
      </p>

      <div class="config-section">
        <label for="apiUrl">API URL</label>
        <input
          type="url"
          id="apiUrl"
          value="https://www.bradmcgonigle.com/api/links"
          placeholder="https://yoursite.com/api/links"
        />

        <label for="apiKey">API Key</label>
        <input
          type="password"
          id="apiKey"
          placeholder="Enter your API key"
        />

        <button onclick="generateBookmarklet()">Generate Bookmarklet</button>
      </div>
    </section>

    <section id="bookmarklet-section" style="display: none">
      <h2>
        Desktop Browsers <span class="badge">Drag to Bookmarks Bar</span>
      </h2>
      <p>Drag this button to your bookmarks bar:</p>

      <a id="bookmarklet" class="bookmarklet-link" href="#">Save Link</a>

      <div class="warning">
        <strong>Note:</strong> Keep your API key secret! Anyone with the
        bookmarklet can save links to your site.
      </div>
    </section>

    <section>
      <h2>iOS Shortcut <span class="badge">Share Sheet</span></h2>
      <p>
        For the best mobile experience, create an iOS Shortcut that appears in
        the Share Sheet:
      </p>

      <ol>
        <li>Open the <strong>Shortcuts</strong> app on your iPhone/iPad</li>
        <li>Tap <strong>+</strong> to create a new shortcut</li>
        <li>
          Add action: <code>Receive input from Share Sheet</code> (URLs only)
        </li>
        <li>Add action: <code>Get URLs from Input</code></li>
        <li>
          Add action: <code>Get Contents of URL</code>
          <ul>
            <li>Method: <strong>POST</strong></li>
            <li>
              Headers: Add <code>x-api-key</code> with your API key, and
              <code>Content-Type</code> with <code>application/json</code>
            </li>
            <li>Request Body: JSON with <code>{"url": "Shortcut Input"}</code></li>
          </ul>
        </li>
        <li>Add action: <code>Show Notification</code> with "Link saved!"</li>
        <li>
          Tap the shortcut name and enable <strong>Show in Share Sheet</strong>
        </li>
      </ol>

      <p>Now you can share any URL to your shortcut to save it!</p>
    </section>

    <section>
      <h2>Environment Variables</h2>
      <p>
        Make sure these environment variables are set on your server:
      </p>

      <pre><code># Required for the API to work
LINKS_API_KEY=your-secret-api-key

# Required for GitHub integration
GITHUB_TOKEN=your-github-personal-access-token
GITHUB_REPO=BradMcGonigle/website
GITHUB_BRANCH=main</code></pre>

      <p>
        The <code>GITHUB_TOKEN</code> needs <code>repo</code> scope to create
        files.
      </p>
    </section>

    <script>
      function generateBookmarklet() {
        const apiUrl = document.getElementById("apiUrl").value;
        const apiKey = document.getElementById("apiKey").value;

        if (!apiUrl || !apiKey) {
          alert("Please enter both API URL and API Key");
          return;
        }

        const code = `javascript:(function(){const API_URL="${apiUrl}";const API_KEY="${apiKey}";const url=window.location.href;const overlay=document.createElement("div");overlay.innerHTML='<div style="position:fixed;top:20px;right:20px;background:%231a1a1a;color:white;padding:16px 24px;border-radius:8px;font-family:-apple-system,sans-serif;font-size:14px;z-index:999999;box-shadow:0 4px 12px rgba(0,0,0,0.3)"><span id="save-link-status">Saving link...</span></div>';document.body.appendChild(overlay);const statusEl=document.getElementById("save-link-status");fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":API_KEY},body:JSON.stringify({url})}).then(r=>r.json()).then(d=>{if(d.success){statusEl.textContent="Link saved!";statusEl.style.color="#4ade80"}else{statusEl.textContent="Error: "+(d.error||"Unknown");statusEl.style.color="#f87171"}}).catch(e=>{statusEl.textContent="Error: "+e.message;statusEl.style.color="#f87171"}).finally(()=>{setTimeout(()=>overlay.remove(),2000)})})();`;

        const bookmarklet = document.getElementById("bookmarklet");
        bookmarklet.href = code;

        document.getElementById("bookmarklet-section").style.display = "block";
      }
    </script>
  </body>
</html>
